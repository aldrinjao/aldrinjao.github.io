<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin="" />






<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
    integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
    crossorigin=""></script>


<link rel="stylesheet" href="./marker-cluster/dist/MarkerCluster.css" />
<link rel="stylesheet" href="./marker-cluster/dist/MarkerCluster.Default.css" />
<script src="./marker-cluster/dist/leaflet.markercluster-src.js"></script>


<script src="./data/data.js"></script>
<script src="./data/munc.js"></script>
<script src="./data/regcov.js"></script>
<script src="./data/covprov.js"></script>

<div id="mapid">


    <div id="dimmedOverlay" onclick="modalClose()"></div>
    <div id="introModal" onclick="modalClose()">
        <img src="./icons/info.svg" class="infoicon "
            style="position: absolute; left:20;top:25; width: 25px;cursor:pointer;">

        <div class="modalTitle">
            Welcome to the Critical Events and Monitoring System <br> Map of COVID-19 Related Incidents!

        </div>
        <div>
            <h3>What this is:</h3>
        </div>

        <div>
            <p>
                In response to the COVID-19 situation, International Alert Philippines expanded its Critical Events
                Monitoring System (CEMS) to monitor tensions and violence related to the pandemic. The reports are
                visually presented through maps with the objective of not only for information dissemination but also
                for data utilization in terms of programming among local governments to effectively respond to the
                tensions and pressures which may lead to violent conflict.
            </p>
        </div>

        <div>
            <h3>How to Use:</h3>
        </div>
        <div class="tutItem">
            <div style="float: left;width: 100px;">
                <img class="img-valign" src="./icons/tutlayers.png" style="width: 100px;">
            </div>
            <div style="float: left;width: 490px;"><span style="font-weight: bold;">Click</span> on the buttons on the
                control panel to switch to different map
                of overlays</div>

        </div>

        <div class="tutItem">
            <div style="float: left;width: 100px;">
                <img class="img-valign" src="./icons/tutmarkers.png" style="width: 100px;">
            </div>
            <div style="float: left;width: 490px;"><span style="font-weight: bold;">Check</span> checkboxes to display
                the reported incidents related to
                COVID-19</div>

        </div>


        <div class="tutItem">
            <div style="float: left;width: 100px;">
                <img class="img-valign" src="./icons/tutmarker.png" style="width: 100px;">
            </div>
            <div style="float: left;width: 490px;"><span style="font-weight: bold;">Click</span> the circle icon to see
                all reports within that area</div>

        </div>

        <div class="tutItem">
            <div style="float: left;width: 100px;">
                <img class="img-valign" src="./icons/tutcontrol.png" style="width: 100px;">
            </div>
            <div style="float: left;width: 490px;"><span style="font-weight: bold;">Interact</span> with the map by
                zooming in and out, adjusting the overlay
                opacity, and changing basemaps.</div>

        </div>




        <!-- 

        <div class="tutItem">
            
        </div>
        <div class="tutItem">
            Interact with the map by zooming in and out, adjusting the overlay opacity, and changing basemaps.
        </div>

        <div class="tutItem">
            Share the page to raise awareness about critical events related to COVID-19
        </div> -->


        <div style="position: absolute;bottom: 1%;text-align: center;width: 93%;">
            Click to close
        </div>









    </div>


    <div id="mapControlPanel">
        <img src="./icons/info.svg" class="infoicon" title="Click to view the tutorial window"
            style="position: absolute; right:10;top:10; width: 20px;cursor:pointer;" onclick="modalOpen()">



        <div id="apptitle">
            <span style="font-size:22px;line-height: normal;font-weight: 600;"> CRITICAL EVENTS MONITORING SYSTEM</span>
            <span style="font-size:20px;line-height: normal;font-weight: 300;"> MAP OF COVID-19 RELATED INCIDENTS</span>
        </div>

        <div id="boundaryPanel">
            <div style="width: 100%;margin: auto;width: 100%; text-align: center;"><span
                    style="font-size: 16px;padding:10px;" title="Administrative Boundaries">Boundaries</span></div>

            <div id="locreg" class='boundarybutton bbleft selected' onclick="locButtonSelected(this)">Region</div>
            <div id="locprov" class='boundarybutton bbright' onclick="locButtonSelected(this)">Province</div>
            <div id="locmun" class='boundarybutton bbleft' onclick="locButtonSelected(this)">Municipality</div>
            <div id="locbrg" class='boundarybutton bbright' onclick="locButtonSelected(this)">Barangay</div>
        </div>

        <div id="issuesPanel">
            <div style="width: 100%;"><span style="font-size: 16px;padding:5px;margin: 5px;">CEMS COVID-19
                    Incidents</span></div>

            <div style="margin:10px">
                <div style="float: left;">
                    <input type="checkbox" id="govcbox" checked onclick="markerCheckBox()">
                    <img src='./icons/green.png' style="width: 20px;">
                </div>
                <div style="float: left;width:70%;margin-left:5px;"> Government/Private Sector Response</div>
            </div>
            <p class="clear">&nbsp;</p>
            <div style="margin:10px">
                <div style="float: left;">
                    <input class="img-valign" type="checkbox" id="tencbox" checked onclick="markerCheckBox()">
                    <img class="img-valign" src='./icons/yellow.png' style="width: 20px;">
                </div>
                <div style="float: left;width:70%;margin:5px;">Tension</div>

            </div>
            <p class="clear">&nbsp;</p>
            <div style="margin:10px">
                <div style="float: left;">
                    <input class="img-valign" type="checkbox" id="viocbox" checked onclick="markerCheckBox()">
                    <img class="img-valign" src='./icons/red.png' style="width: 20px;">
                </div>
                <div style="float: left;width:70%;margin:5px ;">Violence</div>

            </div>
            <p class="clear">&nbsp;</p>

        </div>


        <div id="dohPanel">
            <div style="width: 100%;"><span style="font-size: 16px;padding:15px;margin: 15px;">DOH COVID-19 Cases</span>
            </div>
            <div id="dontshow" class='boundarybutton bbright selected' onclick="dohButtonSelected(this)">Don't show
            </div>

            <div id="show" class='boundarybutton bbright' onclick="dohButtonSelected(this)">Show
            </div>

        </div>


        <div id="panelfooter" style="display:flex;align-items:flex-end;">

            <div>
                <img src="./icons/alert-logo.png" width="40px">
            </div>
            <div>
                <img src="./icons/ausaid.png" width="80px">

            </div>


        </div>



    </div>

    <div id="mapControlIcon" onclick="hideicon()">
    </div>


    <div class="slidecontainer">
        <div>
            <img class="img-valign" src="./icons/opacity.png" style="height: 13.64px;"> <span>opacity</span>

        </div>
        <input type="range" min="0" max="100" value="30" class="slider" id="myRange" style="width:129px;">
    </div>


</div>












<style>
    body {
        margin: 0;
    }

    #mapid {
        height: 100vh;
    }

    #mapConrolPanel:hover {
        cursor: pointer;

    }

    #dimmedOverlay {
        z-index: 1001;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        position: absolute;
        top: 0;
        left: 0;

    }

    #introModal {
        z-index: 2000;
        width: 700px;
        min-height: 620px;
        height: 620px;
        background-color: rgba(255, 255, 255, 0.95);
        position: absolute;
        left: 20%;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        margin: auto;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: rgba(255, 255, 255, 0.95);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        border-radius: 5px;
        padding: 10px;
    }

    .hiddenmodal {
        display: none;
    }

    #mapControlPanel {
        z-index: 401;
        width: 250px;
        height: 90%;
        position: absolute;
        top: 10px;
        left: 10px;


        padding: 12px 18px;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: rgba(240, 240, 240, 0.95);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        border-radius: 5px;
    }

    #mapControlIcon {
        z-index: 401;
        width: 50px;
        height: 50px;
        position: absolute;
        top: 10px;
        left: 10px;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: rgba(255, 255, 255, 0.95);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        border-radius: 5px;
        display: none;
    }

    #panelfooter div {
        margin: 10px;
    }

    /* start slider */

    .slidecontainer {
        padding: 6px 8px;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: white;
        background: rgba(255, 255, 255, 0.9);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        border-radius: 5px;

        z-index: 401;
        width: 135;
        position: absolute;
        top: 10px;
        right: 50px;
        border-radius: 4px;
        padding: 2px;
        /* Width of the outside container */
    }

    .img-valign {
        vertical-align: middle;
    }

    /* end slider */
    .marker-cluster-small {
        background-color: rgba(24, 78, 81, 0.6);
    }

    .marker-cluster-small div {
        background-color: rgba(24, 78, 81, 0.8);
    }

    .marker-cluster-medium {
        background-color: rgba(24, 78, 81, 0.6);
    }

    .marker-cluster-medium div {
        background-color: rgba(24, 78, 81, 0.8);
    }

    .marker-cluster-large {
        background-color: rgba(24, 78, 81, 0.6);
    }

    .marker-cluster div {
        background-color: rgba(24, 78, 81, 0.8);
    }

    .marker-cluster span {
        color: white;
        font-weight: bold;
    }



    .info {
        padding: 6px 8px;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: white;
        background: rgba(255, 255, 255, 0.8);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        border-radius: 5px;
    }

    .info h4 {
        margin: 0 0 5px;
        color: #777;
    }

    .infoIcon svg:hover {
        fill: #fce57e;
    }

    .legend {
        line-height: 20px;
        color: #555;
    }

    .legend i {
        width: 18px;
        height: 18px;
        float: left;
        margin-right: 8px;
        opacity: 0.7;
    }

    .popuplabel {
        font: 14px/16px Arial, Helvetica, sans-serif;
        font-weight: bold;
    }


    #apptitle {
        font: 14px/16px Arial, Helvetica, sans-serif;

    }

    #boundaryPanel {

        margin: 25px 0px 0px 0px;
        padding: 10px 10px;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: rgba(250, 250, 250, 0.8);
        border-radius: 5px;
        height: 100px;

    }

    #dohPanel {

        margin: 25px 0px 0px 0px;
        padding: 10px 10px;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: rgba(250, 250, 250, 0.8);
        border-radius: 5px;
        height: 60px;

    }

    #issuesPanel {
        margin: 25px 0px 0px 0px;
        padding: 10px 10px;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: rgba(250, 250, 250, 0.8);
        border-radius: 5px;
        height: 140px;

    }

    .boundarybutton {
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: rgba(240, 240, 240, 1);
        box-shadow: 0 0 2px rgba(50, 50, 50, 0.8);
        border-radius: 5px;
        width: 35%;
        padding: 10px;
        margin: 5px;
        text-align: center;
        cursor: pointer;
    }

    .bbleft {
        float: left;
    }

    .bbright {
        float: right;
    }

    .selected {
        background: gray;
        font-weight: bold;
        color: white;
    }

    .clear {
        clear: both;
        height: 0px;
    }


    /* modal */

    .modalTitle {
        margin: 2%;
        line-height: normal;
        font: Arial, Helvetica, sans-serif;
        font-size: 1.8em;
        text-align: center;
    }

    #introModal div {
        margin: 2%;
    }

    .tutItem {
        font-size: 1.3em;
        line-height: normal;
        height: 73px;
    }
</style>


<script>

    var mapOptions = {
        zoomControl: false,
        minZoom: 5,
        maxZoom: 18
    }

    var map = L.map('mapid', mapOptions).setView([12, 120], 5);

    map.dragging.disable();
    map.touchZoom.disable();
    map.doubleClickZoom.disable();
    map.scrollWheelZoom.disable();
    map.boxZoom.disable();
    map.keyboard.disable();



    map.setMaxBounds(map.getBounds());
    map.setView([12, 120], 6);
    map.createPane('labels');


    map.getPane('labels').style.zIndex = 500;
    map.getPane('labels').style.pointerEvents = 'none';


    var currentstlye = style1;
    L.control.zoom({
        position: 'topright'
    }).addTo(map);



    var positron = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png', {
        attribution: '©OpenStreetMap, ©CartoDB'
    }).addTo(map);

    var positronLabels = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png', {
        attribution: '©OpenStreetMap, ©CartoDB',
        pane: 'labels'
    }).addTo(map);





    var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    })

    var googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}&language=EN', {
        subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
    });

    var googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}&language=EN', {
        subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
    });

    var googleTerrain = L.tileLayer('http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}&language=EN', {
        subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
    });

    var googleHybrid = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}&language=EN', {
        subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
    });



    var baseMaps = {
        "Carto DB": positron,
        "Google Satellite": googleSat,
        "Google Hyybrid": googleHybrid,
        "Google Streets": googleStreets,
        "Google Terrain": googleTerrain,
        "Open Street Maps": osm
    };

    var overlays = {
        "Carto DB Labels": positronLabels
    }
    L.control.layers(baseMaps, overlays).addTo(map);

    // var imageUrl = './munchair.png',
    //     imageBounds = [[21.011755276, 114.281533786], [4.477399243, 126.604957428]];

    // var imageUrlLarge = './muncovid.png',
    //     imageBounds = [[21.011755276, 114.281533786], [4.477399243, 126.604957428]];


    // var muncZoomedIn = L.imageOverlay(imageUrl, imageBounds);
    // var muncZoomedOut = L.imageOverlay(imageUrlLarge, imageBounds);


    geojson = L.geoJson(regcov, {
        style: style1,
        onEachFeature: onEachFeature
    }).addTo(map);



    // add markers

    var markers = L.markerClusterGroup();


    var IssueIcon = L.Icon.extend({
        options: {
            iconSize: [32, 42],
            popupAnchor: [0, -20]
            // shadowSize: [50, 64],
            // iconAnchor: [22, 94],
            // shadowAnchor: [4, 62],
            // popupAnchor: [-3, -76]
        }
    });

    var greenIcon = new IssueIcon({
        iconUrl: './icons/green.png',
    })
    var yellowIcon = new IssueIcon({
        iconUrl: './icons/yellow.png',
    })
    var redIcon = new IssueIcon({
        iconUrl: './icons/red.png',
    })


    var arrayLength = incidentdata.length;

    var govIssues = [];
    var tenIssues = [];
    var vioIssues = [];

    var allIssues = [];

    //sort the incidents
    for (var i = 0; i < arrayLength; i++) {

        var temp;
        if (incidentdata[i].issue == 'Tensions') {
            tenIssues.push(incidentdata[i]);
            temp = yellowIcon;
        } else if (incidentdata[i].issue == 'Government/Private sector response') {
            govIssues.push(incidentdata[i]);
            temp = greenIcon;
        } else if (incidentdata[i].issue == 'Violence') {
            vioIssues.push(incidentdata[i]);
            temp = redIcon;
        }

        //Do something
    }



    markerCheckBox();




    var info = L.control();

    info.onAdd = function (map) {
        this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
        this.update();
        return this._div;
    };

    // method that we will use to update the control based on feature properties passed
    info.update = function (props) {

        if (currentstlye == style0) {

            this._div.innerHTML =
                '<h4>Covid Cases (May 25, 2020)</h4>' +
                (props ? '<h4>' + props.ADM3_EN + '</h4> ' : '') +
                (props ? '' + props.covmunc2 + ' confirmed cases' : 'Hover over a an area');

        } else {
            this._div.innerHTML =
                '<h4>Area</h4>' +
                (props ? '<h4>' + props.ADM3_EN + '</h4> ' : '');


        }
    };
    info.addTo(map);









    var legend = L.control({ position: 'topright' });

    legend.onAdd = function (map) {

        var div = L.DomUtil.create('div', 'info legend'),
            grades = [1, 25, 50, 100, 200, 500, 1000],
            labels = [];

        // loop through our density intervals and generate a label with a colored square for each interval
        for (var i = 0; i < grades.length; i++) {
            div.innerHTML +=
                '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
                grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
        }

        return div;
    };




    var slider = document.getElementById("myRange");


    slider.oninput = function () {

        geojson.setStyle({

            fillOpacity: (100 - this.value) / 100
        });

    }




    function markerCheckBox() {
        allIssues = [];
        // Get the checkbox
        var tencheckBox = document.getElementById("tencbox");
        var viocheckBox = document.getElementById("viocbox");
        var govcheckBox = document.getElementById("govcbox");
        // Get the output text

        // If the checkbox is checked, display the output text
        if (tencheckBox.checked == true) {
            allIssues = allIssues.concat(tenIssues);
        }
        if (govcheckBox.checked == true) {
            allIssues = allIssues.concat(govIssues);
        }
        if (viocheckBox.checked == true) {
            allIssues = allIssues.concat(vioIssues);
        }
        markers.clearLayers();

        createMarkers();


        // markers.addTo(map);
    }



    function createMarkers() {

        for (var i = 0; i < allIssues.length; i++) {

            var temp;
            if (allIssues[i].issue == 'Tensions') {
                temp = yellowIcon;
            } else if (allIssues[i].issue == 'Government/Private sector response') {
                temp = greenIcon;
            } else if (allIssues[i].issue == 'Violence') {
                temp = redIcon;
            }
            var marker = L.marker(new L.LatLng(allIssues[i].lat, allIssues[i].lng), { title: allIssues[i].issue, icon: temp });
            var town;
            if (allIssues[i].municipality != "") {
                town = allIssues[i].municipality
            } else {
                town = allIssues[i].city
            }
            var popuphtml =
                "<span class='popuplabel'>Date: </span>" + allIssues[i].date + "&nbsp&nbsp&nbsp&nbsp<span class='popuplabel'>Date Reported:</span> " + allIssues[i].datereported +
                "<br><span class='popuplabel'>Issue: </span>" + allIssues[i].issue + "<br>" +
                "<span class='popuplabel'>City/Municipality: </span>" + town + "<br>" +
                "<span class='popuplabel'>Details: </span>" + allIssues[i].details + "<br>"
            marker.bindPopup(popuphtml);
            markers.addLayer(marker);

        }

        map.addLayer(markers);

    }




    function getColor(d) {
        //alert(d);
        return d > 1000 ? '#67340B' :
            d > 500 ? '#834311' :
                d > 200 ? '#964C15' :
                    d > 100 ? '#A45518' :
                        d > 50 ? '#B5651D' :
                            d > 25 ? '#C89C49' :
                                d > 1 ? '#FFEDA0'
                                    : '#FFFFFF';
    }


    function style0(feature) {
        var opacity = (100 - document.getElementById("myRange").value) / 100;

        return {
            fillColor: getColor(feature.properties.covmunc2),
            weight: 2,
            opacity: .1,
            color: 'white',
            dashArray: '3',
            fillOpacity: opacity
        };
    }


    function style1() {
        var opacity = (100 - document.getElementById("myRange").value) / 100;

        return {
            fillColor: 'white',
            weight: 2,
            opacity: 1,
            color: 'black',
            dashArray: '3',
            fillOpacity: opacity
        };
    }



    function highlightFeature(e) {
        var layer = e.target;
        info.update(layer.feature.properties);
        console.log('2');
    }

    function resetHighlight(e) {
        // geojson.resetStyle(e.target);

    }

    function zoomToFeature(e) {
        map.fitBounds(e.target.getBounds());
    }

    function onEachFeature(feature, layer) {
        layer.on({
            mouseover: highlightFeature,
            mouseout: resetHighlight,
            click: zoomToFeature
        });
    }

    // zoomedOut.setOpacity(.5);//pwede icontrol


    function switchlayer(layer) {
        map.removeLayer(geojson);

        if (layer == 'locreg') {
            layer = regcov;

        } else if (layer == 'locmun') {
            layer = muncov;
        } else if (layer == 'locprov') {
            layer = provcov;
        } else if (layer == 'locbrg') {
            layer = brgcov;
        }

        geojson = L.geoJson(layer, {
            style: currentstlye,
            onEachFeature: onEachFeature

        }).addTo(map);


    }


    function removeSelected() {
        document.getElementById('dontshow').classList.remove('selected');
        document.getElementById('show').classList.remove('selected');

    }

    function removeLoCSelected() {
        document.getElementById('locreg').classList.remove('selected');
        document.getElementById('locprov').classList.remove('selected');
        document.getElementById('locmun').classList.remove('selected');
        document.getElementById('locbrg').classList.remove('selected');

    }

    function setSelected(id) {
        document.getElementById(id).classList.add('selected');
    }


    function dohButtonSelected(t) {
        removeSelected();
        setSelected(t.id);
        if (t.id == 'dontshow') {
            currentstlye = style1
            map.removeControl(legend);
        }
        else {
            currentstlye = style0

            map.addControl(legend);

        }
        geojson.setStyle(currentstlye);
    }





    function locButtonSelected(t) {

        if (t.id == "dontshow") {

            geojson.setStyle(style1);
            map.removeControl(legend);
            map.removeControl(info);
            removeLoCSelected();
            setSelected(t.id);

        } else {
            removeLoCSelected()
            // map.addControl(info);
            // map.addControl(legend);
            switchlayer(t.id);
            setSelected(t.id);
        }
    }


    document.getElementById('mapControlPanel').addEventListener('mouseenter', function () {

        map.dragging.disable();
        map.touchZoom.disable();
        map.doubleClickZoom.disable();
        map.scrollWheelZoom.disable();
        map.boxZoom.disable();
        map.keyboard.disable();

    });




    document.getElementById('mapControlPanel').addEventListener('mouseleave', function () {
        map.dragging.enable();
        map.touchZoom.enable();
        map.doubleClickZoom.enable();
        map.scrollWheelZoom.enable();
        map.boxZoom.enable();
        map.keyboard.enable();

    });


    function modalClose() {
        map.dragging.enable();
        map.touchZoom.enable();
        map.doubleClickZoom.enable();
        map.scrollWheelZoom.enable();
        map.boxZoom.enable();
        map.keyboard.enable();

        document.getElementById('dimmedOverlay').classList.add('hiddenmodal');
        document.getElementById('introModal').classList.add('hiddenmodal');

    }

    function modalOpen() {

        map.dragging.disable();
        map.touchZoom.disable();
        map.doubleClickZoom.disable();
        map.scrollWheelZoom.disable();
        map.boxZoom.disable();
        map.keyboard.disable();

        document.getElementById('dimmedOverlay').classList.remove('hiddenmodal');
        document.getElementById('introModal').classList.remove('hiddenmodal');
    }

</script>